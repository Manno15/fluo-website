<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/stylesheets/fluo.css">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Montserrat:700,400">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Merriweather">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" >
    <link rel="canonical" href="https://fluo.apache.org//docs/fluo-recipes/1.0.0-incubating/table-optimization/">
    <link rel="icon" type="image/png" href="/resources/favicon.png">
    <title>Fluo Table Optimization | Apache Fluo</title>
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div id="fluo-nav" class="navbar navbar-default navbar-static-top">
      <div class="container">
        <div class="navbar-header">
          <div class="navbar-toggle-wrapper visible-xs">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".js-navbar-collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
          </div>
          <a href="/" class="navbar-brand"><img src="/resources/fluo-logo.png" alt="Apache Fluo"></a>
        </div>
        <div class="collapse navbar-collapse js-navbar-collapse" style="margin-top: 20px">
          <ul class="navbar-nav nav">
            <li><a href="/release/">Releases</a></li>
            <li><a href="/tour/">Tour</a></li>
            <li><a href="/docs/">Docs</a></li>
            <li><a href="/api/">API</a></li>
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#">Community<span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="/getinvolved/">Get Involved</a></li>
                <li><a href="/news/">News Archive</a></li>
                <li><a href="/people/">People</a></li>
                <li><a href="/related-projects/">Related Projects</a></li>
                <li><a href="/poweredby/">Powered By</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#">Contributing<span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="/how-to-contribute/">How To Contribute</a></li>
                <li><a href="/release-process/">Release Process</a></li>
              </ul>
            </li>
          </ul>
          <ul class="navbar-nav nav navbar-right">
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#">Apache Software Foundation<span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="https://www.apache.org">Apache Homepage</a></li>
                <li><a href="https://www.apache.org/licenses/LICENSE-2.0">License</a></li>
                <li><a href="https://www.apache.org/foundation/sponsorship">Sponsorship</i></a></li>
                <li><a href="https://www.apache.org/security">Security</a></li>
                <li><a href="https://www.apache.org/foundation/thanks">Thanks</a></li>
                <li><a href="https://www.apache.org/foundation/policies/conduct">Code of Conduct</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="container">
      <div class="row">
          <div class="col-sm-12">
            <div class="fluo-doc">

  

  

  <header class="post-header">
    <h2 class="post-title">Fluo Table Optimization</h2>
  </header>

  <article id="page-content">
    <h2 id="background">Background</h2>

<p>Recipes may need to make Accumulo specific table modifications for optimal
performance.  Configuring the Accumulo tablet balancer and adding splits are
two optimizations that are currently done.  Offering a standard way to do these
optimizations makes it easier to use recipes correctly.  These optimizations
are optional.  You could skip them for integration testing, but would probably
want to use them in production.</p>

<h2 id="java-example">Java Example</h2>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">FluoConfiguration</span> <span class="n">fluoConf</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1">//export queue configure method will return table optimizations it would like made</span>
<span class="n">ExportQueue</span><span class="o">.</span><span class="na">configure</span><span class="o">(</span><span class="n">fluoConf</span><span class="o">,</span> <span class="o">...);</span>

<span class="c1">//CollisionFreeMap.configure() will return table optimizations it would like made</span>
<span class="n">CollisionFreeMap</span><span class="o">.</span><span class="na">configure</span><span class="o">(</span><span class="n">fluoConf</span><span class="o">,</span> <span class="o">...);</span>

<span class="c1">//configure optimizations for a prefixed hash range of a table</span>
<span class="n">RowHasher</span><span class="o">.</span><span class="na">configure</span><span class="o">(</span><span class="n">fluoConf</span><span class="o">,</span> <span class="o">...);</span>

<span class="c1">//initialize Fluo</span>
<span class="n">FluoFactory</span><span class="o">.</span><span class="na">newAdmin</span><span class="o">(</span><span class="n">fluoConf</span><span class="o">).</span><span class="na">initialize</span><span class="o">(...)</span>

<span class="c1">//Automatically optimize the Fluo table for all configured recipes</span>
<span class="n">TableOperations</span><span class="o">.</span><span class="na">optimizeTable</span><span class="o">(</span><span class="n">fluoConf</span><span class="o">);</span>
</code></pre>
</div>

<p><a href="https://static.javadoc.io/org.apache.fluo/fluo-recipes-accumulo/1.0.0-incubating/org/apache/fluo/recipes/accumulo/ops/TableOperations.html">TableOperations</a> is provided in the Accumulo module of Fluo Recipes.</p>

<h2 id="command-example">Command Example</h2>

<p>Fluo Recipes provides an easy way to optimize a Fluo table for configured
recipes from the command line.  This should be done after configuring reciped
and initializing Fluo.  Below are example command for initializing in this way.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code>
<span class="c">#create application </span>
fluo new app1

<span class="c">#configure application</span>

<span class="c">#initialize Fluo</span>
fluo init app1

<span class="c">#optimize table for all configured recipes</span>
fluo <span class="nb">exec </span>app1 org.apache.fluo.recipes.accumulo.cmds.OptimizeTable
</code></pre>
</div>

<h2 id="table-optimization-registry">Table optimization registry</h2>

<p>Recipes register themself by calling <a href="https://static.javadoc.io/org.apache.fluo/fluo-recipes-core/1.0.0-incubating/org/apache/fluo/recipes/core/common/TableOptimizations.html">TableOptimizations.registerOptimization()</a>.  Anyone can use
this mechanism, its not limited to use by exisitng recipes.</p>


  </article>

</div>

          </div>
      </div>
      <hr>
      <div class="row footer">
        <div class="col-sm-12 text-center">
          <div class="center-block">
          <a href="https://apache.org"><img src="/resources/feather.png" alt="Apache"></a>
          Copyright &copy; 2016 The Apache Software Foundation. Licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache&nbsp;License,&nbsp;Version&nbsp;2.0</a>
          </div>
        </div>
      </div>
    </div>
    <script src="/javascripts/jquery.min.js"></script>
    <script src="/javascripts/bootstrap.min.js"></script>
    <!-- Place your <script> tags here. -->

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55360307-1', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>
